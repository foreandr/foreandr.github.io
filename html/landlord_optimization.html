<!-- =========================
     LANDLORD OPTIMIZATION UI
     (Scoped ONLY to the PTBO letter)
     ========================= -->

<style>
/* PAGE CONTEXT (kept light for embedding) */
body {
  background-color: #f4f6f8;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  color: #333;
}

/* ROOT WRAPPER */
#landlord-optimizer {
  position: relative;
  max-width: 1180px;
  margin: 50px auto;
  padding: 36px 36px 60px 36px;
  background-color: #ffffff;
  border-radius: 12px;
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.1);
  z-index: 1;
}

/* TITLE AREA */
#landlord-optimizer h1 {
  color: #2c3e50;
  font-size: 2.2em;
  margin-bottom: 6px;
  text-align: center;
}
#landlord-optimizer .subtitle {
  color: #7f8c8d;
  font-style: italic;
  margin-bottom: 10px;
  text-align: center;
}

/* BUTTONS (top) */
.button-row {
  display: flex;
  justify-content: center;
  gap: 18px;
  margin: 16px 0 24px 0;
  flex-wrap: wrap;
}
.lop-btn {
  background-color: #3498db;
  color: #fff;
  padding: 11px 26px;
  border: none;
  border-radius: 8px;
  font-size: 0.95em;
  cursor: pointer;
  transition: background-color 0.25s ease;
}
.lop-btn:hover {
  background-color: #2980b9;
}

/* SUMMARY / PUNCHLINES */
#lop-summary {
  margin-bottom: 26px;
  border-radius: 10px;
  padding: 16px 20px;
  font-size: 1rem;
  line-height: 1.5;
  text-align: left;
}
.lop-summary--profit {
  background: #e8f8f5;
  color: #16613a;
  border: 1px solid #1abc9c;
}
.lop-summary--noprofit {
  background: #fdecea;
  color: #922b21;
  border: 1px solid #e74c3c;
}
#lop-summary h3 {
  margin: 0 0 6px 0;
  font-size: 1.05rem;
}

/* FORM GRID */
.input-section {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
  gap: 16px;
  margin-bottom: 25px;
}

.input-card {
  background-color: #ecf0f1;
  border-radius: 8px;
  padding: 16px 16px 12px 16px;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.03);
}

.input-card h3 {
  margin: 0 0 10px 0;
  font-size: 1em;
  color: #2c3e50;
}

.input-card label {
  display: block;
  font-weight: 600;
  margin-bottom: 5px;
  font-size: 0.85em;
}

.input-card input {
  width: 100%;
  padding: 8px 6px;
  border: 1px solid #bdc3c7;
  border-radius: 4px;
  font-size: 0.9em;
  background: #fff;
}

/* DETAILS (math trace) */
#lop-math-details {
  margin-top: 12px;
  background: #f9f9f9;
  border-radius: 8px;
  padding: 10px 14px;
  text-align: left;
}
#lop-math-details summary {
  font-weight: 600;
  cursor: pointer;
}
#lop-math-text {
  margin-top: 8px;
}
.lop-year-block {
  background: #ffffff;
  border: 1px solid #e0e0e0;
  border-radius: 6px;
  padding: 10px 12px 8px 12px;
  margin-bottom: 10px;
}
.lop-year-title {
  font-weight: 700;
  font-size: 1.05rem;
  text-decoration: underline;
  margin-bottom: 6px;
}
.lop-math-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.82rem;
}
.lop-math-table tr td {
  padding: 3px 4px;
  border-bottom: 1px solid #f1f1f1;
}
.lop-math-table tr:last-child td {
  border-bottom: none;
}
.lop-math-label {
  width: 46%;
}
.lop-math-value {
  width: 32%;
  text-align: right;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}
.lop-math-delta {
  width: 22%;
  text-align: right;
  font-weight: 600;
}
.lop-pos { color: #1e8449; }
.lop-neg { color: #922b21; }
.lop-math-formula {
  background: #f5f5f5;
  border-radius: 4px;
  padding: 7px 8px 4px 8px;
  margin-top: 6px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: 0.78rem;
  white-space: pre-wrap;
}

/* CHART AREA (6 cards) */
.charts-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(310px, 1fr));
  gap: 30px;
  align-items: stretch;
  margin-top: 34px;
}

.chart-card {
  background: #fff;
  border-radius: 10px;
  box-shadow: 0 2px 14px rgba(0, 0, 0, 0.05);
  padding: 14px;
  min-height: 380px;
}

.chart-card h4 {
  margin-bottom: 10px;
  font-size: 1em;
  color: #2c3e50;
  text-align: center;
}

.chart-card canvas {
  width: 100% !important;
  height: 300px !important;
}

/* SPIDER BACKGROUND */
#spiderweb {
  position: fixed;
  top: 0;
  left: 0;
  z-index: -1;
  width: 100vw;
  height: 100vh;
  pointer-events: none;
}

/* RESPONSIVE */
@media (max-width: 640px) {
  #landlord-optimizer {
    margin: 20px;
    padding: 20px;
  }
  #landlord-optimizer h1 {
    font-size: 1.7em;
  }
}
</style>

<!-- ======= SPIDER CANVAS ======= -->
<canvas id="spiderweb"></canvas>

<!-- ======= CONTENT ======= -->
<div id="landlord-optimizer">
  <h1>Landlord Optimization Platform</h1>
  <p class="subtitle">
    Exactly what was in the PTBO message: rents, city taxes, insurance inside expenses, charity rebate, his own mortgage/food, plus one extra income and one extra expense.
  </p>

  <!-- BUTTON (top) -->
  <div class="button-row">
    <button class="lop-btn" onclick="window.generateProjection && window.generateProjection()">Generate Analysis</button>
  </div>

  <!-- SUMMARY / PUNCHLINES -->
  <div id="lop-summary" class="lop-summary--profit">
    <h3>✅ Profitable starting in Year 1</h3>
    <p>After-tax cashflow in Year 1 meets or exceeds your personal target.</p>
  </div>

  <!-- SECTION: BUILDING COMPOSITION + CORE MONEY -->
  <div class="input-section" id="section-composition">
    <div class="input-card">
      <h3>Number of Stores (street level)</h3>
      <label for="lop-stores">count</label>
      <input type="number" id="lop-stores" value="4" min="0">
    </div>
    <div class="input-card">
      <h3>Number of Apartments (upper)</h3>
      <label for="lop-apartments">count</label>
      <input type="number" id="lop-apartments" value="5" min="0">
    </div>
    <div class="input-card">
      <h3>Total Monthly Rent (all 4 stores + 5 apts)</h3>
      <label for="lop-rent">CA$ / month</label>
      <!-- start optimistic -->
      <input type="number" id="lop-rent" value="9200">
    </div>
    <div class="input-card">
      <h3>Monthly Operating Expenses</h3>
      <label for="lop-expenses">tax + insurance + maintenance</label>
      <input type="number" id="lop-expenses" value="3000">
    </div>
  </div>

  <!-- SECTION: OWNER + DEBT -->
  <div class="input-section" id="section-owner">
    <div class="input-card">
      <h3>Mortgage / Debt Service</h3>
      <label for="lop-mortgage">CA$ / month</label>
      <input type="number" id="lop-mortgage" value="700">
    </div>
    <div class="input-card">
      <h3>Your Own Living Costs</h3>
      <label for="lop-personal">CA$ / month you need to live</label>
      <input type="number" id="lop-personal" value="3500">
    </div>
    <div class="input-card">
      <h3>Personal Cost Growth / Yr</h3>
      <label for="lop-personal-growth">%</label>
      <input type="number" id="lop-personal-growth" value="2">
    </div>
  </div>

  <!-- SECTION: GROWTH + HORIZON -->
  <div class="input-section" id="section-growth">
    <div class="input-card">
      <h3>Rent Growth / Yr</h3>
      <label for="lop-rent-growth">%</label>
      <input type="number" id="lop-rent-growth" value="4">
    </div>
    <div class="input-card">
      <h3>Expense Inflation / Yr</h3>
      <label for="lop-exp-inflation">%</label>
      <input type="number" id="lop-exp-inflation" value="3">
    </div>
    <div class="input-card">
      <h3>Property Appreciation / Yr</h3>
      <label for="lop-appreciation">%</label>
      <input type="number" id="lop-appreciation" value="3">
    </div>
    <div class="input-card">
      <h3>Projection Horizon</h3>
      <label for="lop-years">years</label>
      <input type="number" id="lop-years" value="15">
    </div>
  </div>

  <!-- SECTION: TAX / STRUCTURE -->
  <div class="input-section" id="section-tax">
    <div class="input-card">
      <h3>Personal Tax Rate</h3>
      <label for="lop-personal-tax">%</label>
      <input type="number" id="lop-personal-tax" value="35">
    </div>
    <div class="input-card">
      <h3>Corp (Active) Tax Rate</h3>
      <label for="lop-corp-tax">%</label>
      <input type="number" id="lop-corp-tax" value="12">
    </div>
    <div class="input-card">
      <h3>Use Corp Structure?</h3>
      <label for="lop-use-corp">yes=1, no=0</label>
      <input type="number" id="lop-use-corp" value="0" min="0" max="1" step="1">
    </div>
    <div class="input-card">
      <h3>City-tax share of expenses</h3>
      <label for="lop-city-share">% of total expenses that is city/municipal tax</label>
      <input type="number" id="lop-city-share" value="40">
    </div>
    <div class="input-card">
      <h3>Charity / Non-profit Rebate</h3>
      <label for="lop-rebate">property-tax rebate % (0–40)</label>
      <input type="number" id="lop-rebate" value="0">
    </div>
  </div>

  <!-- SECTION: ALT (1 income + 1 expense) -->
  <div class="input-section" id="section-alt">
    <div class="input-card">
      <h3>Alt income (e.g. livestream)</h3>
      <label for="lop-alt-income">CA$ / month</label>
      <input type="number" id="lop-alt-income" value="0">
    </div>
    <div class="input-card">
      <h3>Alt expense (e.g. lights / camera)</h3>
      <label for="lop-alt-expense">CA$ / month</label>
      <input type="number" id="lop-alt-expense" value="0">
    </div>
  </div>

  <!-- DETAILED MATH (open by default) -->
  <details id="lop-math-details" open>
    <summary>Show detailed math (all years)</summary>
    <div id="lop-math-text">Click "Generate Analysis" to see the step-by-step calculations.</div>
  </details>

  <!-- CHARTS (6) -->
  <div class="charts-row">
    <div class="chart-card">
      <h4>Income vs Expenses (Annual)</h4>
      <canvas id="lop-income-chart"></canvas>
    </div>
    <div class="chart-card">
      <h4>Net After Tax (Owner Spendable)</h4>
      <canvas id="lop-net-chart"></canvas>
    </div>
    <div class="chart-card">
      <h4>Revenue Mix (Spider)</h4>
      <canvas id="lop-spider-chart"></canvas>
    </div>
    <div class="chart-card">
      <h4>Property Value vs Costs</h4>
      <canvas id="lop-value-chart"></canvas>
    </div>
    <div class="chart-card">
      <h4>Alt Income vs Alt Expense</h4>
      <canvas id="lop-alt-chart"></canvas>
    </div>
    <div class="chart-card">
      <h4>Pre-Tax vs Tax Paid</h4>
      <canvas id="lop-tax-chart"></canvas>
    </div>
  </div>
</div>
